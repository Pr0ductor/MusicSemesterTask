@using System.Security.Claims
@{
    ViewData["Title"] = "Songs";
}
@model List<MusicSemesterTask.Domain.Entities.Song>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Cat | Basik - Bootstrap 4 Web Application</title>
    <meta name="description" content="Responsive, Bootstrap, BS4">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><!-- style -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/site.min.css">
    <link rel="stylesheet" href="../assets/css/like-button.css">

    <form method="post">
        <input type="hidden" asp-antiforgery="true" />
    </form>
</head>

<body class="layout-row"><!-- ############ Aside START-->
    <div id="aside" class="page-sidenav no-shrink bg-light nav-dropdown fade">
        <div class="sidenav h-100 modal-dialog bg-light"><!-- sidenav top -->
            <div class="navbar"><!-- brand --> <a href="index.html" class="navbar-brand"><svg width="32" height="32"
                        viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                        <g class="loading-spin" style="transform-origin: 256px 256px">
                            <path
                                d="M200.043 106.067c-40.631 15.171-73.434 46.382-90.717 85.933H256l-55.957-85.933zM412.797 288A160.723 160.723 0 0 0 416 256c0-36.624-12.314-70.367-33.016-97.334L311 288h101.797zM359.973 134.395C332.007 110.461 295.694 96 256 96c-7.966 0-15.794.591-23.448 1.715L310.852 224l49.121-89.605zM99.204 224A160.65 160.65 0 0 0 96 256c0 36.639 12.324 70.394 33.041 97.366L201 224H99.204zM311.959 405.932c40.631-15.171 73.433-46.382 90.715-85.932H256l55.959 85.932zM152.046 377.621C180.009 401.545 216.314 416 256 416c7.969 0 15.799-.592 23.456-1.716L201.164 288l-49.118 89.621z">
                            </path>
                        </g>
                    </svg><!-- <img src="../assets/img/logo.png" alt="..."> --> <span
                        class="hidden-folded d-inline l-s-n-1x">Music</span> </a><!-- / brand --></div>
            <!-- Flex nav content -->
            <div class="flex scrollable hover">
                <div class="nav-active-text-primary" data-nav>
                    <ul class="nav bg">
                        <li class="nav-header hidden-folded pt-4"><span class="text-muted">Recommand</span></li>
                        <li>
                            <div class="p-3 nav-fold"><a href="#" class="btn btn-white btn-block text-align-auto"
                                                         data-toggle="dropdown"><i data-feather="bar-chart-2" width="12" height="12"></i>
                                    <span class="mx-1 hidden-folded">Basik top charts</span></a>
                                <div class="dropdown-menu text-sm"><a class="dropdown-item"
                                                                      href="music.charts.html#pop">Pop chart</a> <a class="dropdown-item"
                                                                                                                    href="music.charts.html#hip-pop">Hip-Hop chart</a> <a class="dropdown-item"
                                                                                                                                                                          href="music.charts.html#country">Country chart</a> <a class="dropdown-item"
                                                                                                                                                                                                                                href="music.charts.html#global">Global top 50</a></div>
                            </div>

                        <li class="nav-header hidden-folded">
                            <span class="text-muted">Music</span>
                        </li>

                        <!-- Discover -->
                        <li>
                            <a asp-controller="Home" asp-action="Index">
                                <span class="nav-icon"><i data-feather="disc"></i></span>
                                <span class="nav-text">Discover</span>
                            </a>
                        </li>

                        <!-- Charts -->
                        <li>
                            <a asp-controller="Charts" asp-action="Index">
                                <span class="nav-icon"><i data-feather="trending-up"></i></span>
                                <span class="nav-text">Charts</span>
                            </a>
                        </li>

                        <!-- Songs -->
                        <li>
                            <a asp-controller="Songs" asp-action="Index">
                                <span class="nav-icon"><i data-feather="radio"></i></span>
                                <span class="nav-text">Songs</span>
                            </a>
                        </li>

                        <!-- Artists -->
                        <li>
                            <a asp-controller="Artists" asp-action="Index">
                                <span class="nav-icon"><i data-feather="user"></i></span>
                                <span class="nav-text">Artists</span>
                            </a>
                        </li>

                        <!-- Your Playlist -->
                        <li class="nav-header d-flex nav-fold">
                            <span class="py-2 text-muted hidden-folded">Your Playlist</span>
                            <span class="flex hidden-folded"></span>
                            <a class="text-md" data-toggle="tooltip" data-placement="right" title="Create playlist">
                                <i data-feather="plus" width="12" height="12"></i>
                            </a>
                        </li>
                        <li class="open">
                            <ul class="nav nav-sub">
                                <li><a href="music.detail.html" class="px-2"><span class="nav-text">Classic
											Jazz</span></a></li>
                                <li><a href="music.detail.html#id=1" class="px-2"><span class="nav-text">Hips</span></a>
                                </li>
                                <li><a href="music.detail.html#id=2" class="px-2"><span class="nav-text">50 top
											albums</span></a></li>
                                <li><a href="music.detail.html#id=3" class="px-2"><span class="nav-text">DJ
											2018</span></a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div><!-- sidenav bottom -->
            <div class="no-shrink">
                <div class="nav-fold py-1"><a data-toggle-class="folded" data-target="#aside" class="p-3"><i
                            data-feather="menu"></i></a></div>
            </div>
        </div>
    </div><!-- ############ Aside END-->
    <div id="main" class="layout-column flex bg-white"><!-- ############ Header START-->
	<div id="header" class="page-header">
		<div class="navbar navbar-expand-lg"><!-- brand --> <a href="index.html" class="navbar-brand d-lg-none"><svg
					width="32" height="32" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"
					fill="currentColor">
					<g class="loading-spin" style="transform-origin: 256px 256px">
						<path
							d="M200.043 106.067c-40.631 15.171-73.434 46.382-90.717 85.933H256l-55.957-85.933zM412.797 288A160.723 160.723 0 0 0 416 256c0-36.624-12.314-70.367-33.016-97.334L311 288h101.797zM359.973 134.395C332.007 110.461 295.694 96 256 96c-7.966 0-15.794.591-23.448 1.715L310.852 224l49.121-89.605zM99.204 224A160.65 160.65 0 0 0 96 256c0 36.639 12.324 70.394 33.041 97.366L201 224H99.204zM311.959 405.932c40.631-15.171 73.433-46.382 90.715-85.932H256l55.959 85.932zM152.046 377.621C180.009 401.545 216.314 416 256 416c7.969 0 15.799-.592 23.456-1.716L201.164 288l-49.118 89.621z">
						</path>
					</g>
				</svg><!-- <img src="../assets/img/logo.png" alt="..."> --> <span
					class="hidden-folded d-inline l-s-n-1x d-lg-none">Basik</span>
			</a><!-- / brand --><!-- Navbar collapse -->
			<div class="collapse navbar-collapse order-2 order-lg-1" id="navbarToggler">
				<form class="input-group m-2 my-lg-0">
					<div class="input-group-prepend"><button type="button" class="btn no-shadow no-bg px-0"><i
								data-feather="search"></i></button></div><input type="text"
					                                                            class="form-control no-border no-shadow no-bg typeahead" placeholder="Search..."
					                                                            data-plugin="typeahead" data-api="../assets/api/music.json">
				</form>
			</div>
			<ul class="nav navbar-menu order-1 order-lg-2">
				<li class="nav-item d-none d-sm-block"><a class="nav-link px-2" data-toggle="fullscreen"
				                                          data-plugin="fullscreen"><i data-feather="maximize"></i></a></li>
				<li class="nav-item dropdown"><a class="nav-link px-2" data-toggle="dropdown"><i
							data-feather="settings"></i> </a><!-- ############ Setting START-->
					
				</li><!-- Notification -->
				<li class="nav-item dropdown"><a class="nav-link px-2 mr-lg-2" data-toggle="dropdown"><i
							data-feather="bell"></i> <span class="badge badge-pill badge-up bg-primary"></span>
					</a>
				</li><!-- User dropdown menu -->
                <!-- Меню пользователя -->
                
				<ul class="nav navbar-menu order-1 order-lg-2">
					@if (User.Identity.IsAuthenticated)
					{
						<li class="nav-item dropdown">
							<a href="#" data-toggle="dropdown" class="nav-link d-flex align-items-center px-2 text-color">
								<span class="dropdown-toggle mx-2 d-none l-h-1x d-lg-block text-right">@User.Identity.Name</span>
								@{
									var profilePicture = User.Claims.FirstOrDefault(c => c.Type == "ProfilePictureUrl")?.Value;
									if (!string.IsNullOrEmpty(profilePicture))
									{
										// Если путь начинается с "../", заменяем на "~/"
										profilePicture = profilePicture.StartsWith("../") ? profilePicture.Replace("../", "~/") : profilePicture;
									}
								}
								@if (!string.IsNullOrEmpty(profilePicture))
								{
									<span class="avatar w-24" style="margin: -2px">
										<img src="@Url.Content(profilePicture)" alt="Profile Picture">
									</span>
								}
							</a>
							<div class="dropdown-menu dropdown-menu-right w mt-3 animate fadeIn">
								<a class="dropdown-item" href="#">Profile</a>
								<div class="dropdown-divider"></div>
								<form asp-controller="AuthView" asp-action="Logout" method="post">
									<button type="submit" class="dropdown-item">Sign Out</button>
								</form>
							</div>
						</li>
					}
					else
					{
						<li class="nav-item">
							<a class="nav-link px-2" asp-controller="AuthView" asp-action="Login">Sign In</a>
						</li>
					}
				</ul>
				
				
			</ul>
		</div>
	</div><!-- ############ Header END--><!-- ############ Content START-->
<div id="content" class="flex"><!-- ############ Main START-->
    <div class="page-container">
        <div class="padding sr" id="list" data-plugin="musicapp">
            <div class="heading py-2 d-flex">
                <div>
                    <div class="text-muted text-sm sr-item"></div>
                    <h5 class="text-highlight sr-item">Filter</h5>
                </div><span class="flex"></span>
            </div>
            <div class="pb-1 d-flex sr-item" id="filter-tag">
                <div class="text-muted no-shrink my-2">Contries</div>
                <div class="mx-3"><a class="badge badge-lg bg-light m-1">All countries</a> <a
                                                                                               class="badge badge-lg bg-light m-1">Australia</a> <a
                                                                                                                                                     class="badge badge-lg bg-light m-1">Canada</a> <a
                                                                                                                                                                                                        class="badge badge-lg bg-light m-1">France</a> <a
                                                                                                                                                                                                                                                           class="badge badge-lg bg-light m-1">Germany</a> <a
                                                                                                                                                                                                                                                                                                               class="badge badge-lg bg-light m-1">Ireland</a> <a
                                                                                                                                                                                                                                                                                                                                                                   class="badge badge-lg bg-light m-1">Netherlands</a> <a
                                                                                                                                                                                                                                                                                                                                                                                                                           class="badge badge-lg bg-light m-1">New Zealand</a> <a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   class="badge badge-lg bg-light m-1">United Kingdom</a> <a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              class="badge badge-lg bg-light m-1">USA</a></div>
            </div>
            <div class="pb-4 d-flex sr-item" id="filter-category">
                <div class="text-muted no-shrink my-2">Genres</div>
                <div class="mx-3"><a href="#" class="badge badge-lg bg-light m-1">All genres </a><a href="#"
                                                                                                    class="badge badge-lg bg-light m-1">Acoustic </a><a href="#"
                                                                                                                                                        class="badge badge-lg bg-light m-1">Ambient </a><a href="#"
                                                                                                                                                                                                           class="badge badge-lg bg-light m-1">Blues </a><a href="#"
                                                                                                                                                                                                                                                            class="badge badge-lg bg-light m-1">Classical </a><a href="#"
                                                                                                                                                                                                                                                                                                                 class="badge badge-lg bg-light m-1">Country </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                    class="badge badge-lg bg-light m-1">Electronic </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                          class="badge badge-lg bg-light m-1">Emo </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         class="badge badge-lg bg-light m-1">Folk </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         class="badge badge-lg bg-light m-1">Hardcore </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             class="badge badge-lg bg-light m-1">Hip-Hop </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                class="badge badge-lg bg-light m-1">Indie </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 class="badge badge-lg bg-light m-1">Jazz </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 class="badge badge-lg bg-light m-1">Latin </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  class="badge badge-lg bg-light m-1">Metal </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   class="badge badge-lg bg-light m-1">Pop </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  class="badge badge-lg bg-light m-1">Pop punk </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      class="badge badge-lg bg-light m-1">Punk </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      class="badge badge-lg bg-light m-1">Reggae </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="badge badge-lg bg-light m-1">R&B </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       class="badge badge-lg bg-light m-1">Rock </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       class="badge badge-lg bg-light m-1">Soul </a><a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       class="badge badge-lg bg-light m-1">World</a></div>
            </div>
            <div class="container">
                <h2>Songs</h2>
                <form style="display:none">
                    @Html.AntiForgeryToken()
                </form>
                <div class="row">
                    @foreach (var song in Model)
                    {
                        <div class="col-4 col-sm-4 col-md-3 col-lg-2" data-id="@song.Id" data-category="@song.Genre"
                            data-tag="@song.Country" data-source="@song.AudioUrl">
                            <div class="list-item r">
                                <div class="media">
                                    <a href="#" class="ajax media-content" style="background-image:url(@song.CoverUrl)"></a>
                                    <div class="media-action media-action-overlay">
                                        @if (User.Identity.IsAuthenticated)
                                        {
                                            var userId = User.FindFirst(ClaimTypes.NameIdentifier)?.Value;
                                            <button class="btn btn-icon no-bg no-shadow hide-row" onclick="toggleLike(@song.Id, this)" type="button">
                                                <i data-feather="heart" class="@(song.Likes.Any(l => l.UserId == int.Parse(userId ?? "0")) ? "active-danger" : "")"></i>
                                            </button>
                                        }
                                        <button class="btn btn-raised btn-icon btn-rounded bg--white btn-play" type="button"></button>
                                        <button class="btn btn-icon no-bg no-shadow hide-row btn-more" data-toggle="dropdown" type="button">
                                            <i data-feather="more-horizontal"></i>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-right"></div>
                                    </div>
                                </div>
                                <div class="list-content text-center">
                                    <div class="list-body">
                                        <a href="#" class="list-title title ajax h-1x">@song.Title</a>
                                        <a href="#" class="list-subtitle d-block text-muted subtitle ajax h-1x">@song.Artist?.Name</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
        <script src="../assets/js/site.min.js"></script>
        <script src="../assets/js/site.js"></script>
    </div>
</div>
</body>

</html>