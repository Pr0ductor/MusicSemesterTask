@using Microsoft.AspNetCore.Mvc.TagHelpers
@model MusicSemesterTask.Web.Models.ProfileViewModel

@{
    ViewData["Title"] = "Profile";
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Profile | Music</title>
    <meta name="description" content="Responsive, Bootstrap, BS4">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <link rel="stylesheet" href="../assets/css/site.min.css">
</head>

<body class="layout-row"><!-- ############ Aside START-->
<div id="aside" class="page-sidenav no-shrink bg-light nav-dropdown fade">
	<div class="sidenav h-100 modal-dialog bg-light"><!-- sidenav top -->
		<div class="navbar"><!-- brand --> <a asp-controller="Home" asp-action="Index"><svg width="32" height="32"
		                                                                                  viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
					<g class="loading-spin" style="transform-origin: 256px 256px">
						<path
							d="M200.043 106.067c-40.631 15.171-73.434 46.382-90.717 85.933H256l-55.957-85.933zM412.797 288A160.723 160.723 0 0 0 416 256c0-36.624-12.314-70.367-33.016-97.334L311 288h101.797zM359.973 134.395C332.007 110.461 295.694 96 256 96c-7.966 0-15.794.591-23.448 1.715L310.852 224l49.121-89.605zM99.204 224A160.65 160.65 0 0 0 96 256c0 36.639 12.324 70.394 33.041 97.366L201 224H99.204zM311.959 405.932c40.631-15.171 73.433-46.382 90.715-85.932H256l55.959 85.932zM152.046 377.621C180.009 401.545 216.314 416 256 416c7.969 0 15.799-.592 23.456-1.716L201.164 288l-49.118 89.621z">
						</path>
					</g>
				</svg><!-- <img src="../assets/img/logo.png" alt="..."> --> <span
					class="hidden-folded d-inline l-s-n-1x">Music</span> </a><!-- / brand --></div>
		<!-- Flex nav content -->
		<div class="flex scrollable hover">
			<div class="nav-active-text-primary" data-nav>
				<ul class="nav bg">
					<li class="nav-header hidden-folded pt-4"><span class="text-muted">Recommand</span></li>
					<li>
					<div class="p-3 nav-fold">
						<div class="btn btn-white btn-block text-align-auto">
							<i data-feather="bar-chart-2" width="12" height="12"></i>
							<span class="mx-1 hidden-folded">Basic top charts</span>
						</div>
					</div>
					
					<li class="nav-header hidden-folded">
						<span class="text-muted">Music</span>
					</li>

					<!-- Discover -->
					<li>
						<a asp-controller="Home" asp-action="Index">
							<span class="nav-icon"><i data-feather="disc"></i></span>
							<span class="nav-text">Discover</span>
						</a>
					</li>

					<!-- Charts -->
					<li>
						<a asp-controller="Charts" asp-action="Index">
							<span class="nav-icon"><i data-feather="trending-up"></i></span>
							<span class="nav-text">Charts</span>
						</a>
					</li>

					<!-- Songs -->
					<li>
						<a asp-controller="Songs" asp-action="Index">
							<span class="nav-icon"><i data-feather="radio"></i></span>
							<span class="nav-text">Songs</span>
						</a>
					</li>

					<!-- Artists -->
					<li>
						<a asp-controller="Artists" asp-action="Index">
							<span class="nav-icon"><i data-feather="user"></i></span>
							<span class="nav-text">Artists</span>
						</a>
					</li>

					<!-- Your Playlist -->
					<li class="nav-header d-flex nav-fold">
						<span class="py-2 text-muted hidden-folded">Your Playlist</span>
						<span class="flex hidden-folded"></span>
						<a class="text-md" data-toggle="tooltip" data-placement="right" title="Create playlist">
							<i data-feather="plus" width="12" height="12"></i>
						</a>
					</li>
					<li class="open">
						<ul class="nav nav-sub">
							<li><a href="" class="px-2"><span class="nav-text">Metallica</span></a></li>
							<li><a href="" class="px-2"><span class="nav-text">Мартин</span></a>
							</li>
							<li><a href="" class="px-2"><span class="nav-text">Pop
											albums</span></a></li>
		
						</ul>
					</li>
				</ul>
			</div>
		</div><!-- sidenav bottom -->
		<div class="no-shrink">
			<div class="nav-fold py-1"><a data-toggle-class="folded" data-target="#aside" class="p-3"><i
						data-feather="menu"></i></a></div>
		</div>
	</div>
</div><!-- ############ Aside END-->
<div id="main" class="layout-column flex bg-white"><!-- ############ Header START-->
	<div id="header" class="page-header">
		<div class="navbar navbar-expand-lg"><!-- brand --> <a href="index.html" class="navbar-brand d-lg-none"><svg
					width="32" height="32" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"
					fill="currentColor">
					<g class="loading-spin" style="transform-origin: 256px 256px">
						<path
							d="M200.043 106.067c-40.631 15.171-73.434 46.382-90.717 85.933H256l-55.957-85.933zM412.797 288A160.723 160.723 0 0 0 416 256c0-36.624-12.314-70.367-33.016-97.334L311 288h101.797zM359.973 134.395C332.007 110.461 295.694 96 256 96c-7.966 0-15.794.591-23.448 1.715L310.852 224l49.121-89.605zM99.204 224A160.65 160.65 0 0 0 96 256c0 36.639 12.324 70.394 33.041 97.366L201 224H99.204zM311.959 405.932c40.631-15.171 73.433-46.382 90.715-85.932H256l55.959 85.932zM152.046 377.621C180.009 401.545 216.314 416 256 416c7.969 0 15.799-.592 23.456-1.716L201.164 288l-49.118 89.621z">
						</path>
					</g>
				</svg><!-- <img src="../assets/img/logo.png" alt="..."> --> <span
					class="hidden-folded d-inline l-s-n-1x d-lg-none">Basik</span>
			</a><!-- / brand --><!-- Navbar collapse -->
			<div class="collapse navbar-collapse order-2 order-lg-1" id="navbarToggler">
				<div class="input-group m-2 my-lg-0">
					<div class="input-group-prepend">
						<button type="button" class="btn no-shadow no-bg px-0" disabled style="pointer-events: none;">
							<i data-feather="search"></i>
						</button>
					</div>
					<input type="text" 
                 class="form-control no-border no-shadow no-bg" 
                 placeholder="Search..." 
                 disabled 
                 readonly 
                 style="pointer-events: none; background-color: rgba(0,0,0,0.05);">
        </div>
      </div>
      <ul class="nav navbar-menu order-1 order-lg-2">
        <li class="nav-item d-none d-sm-block"><a class="nav-link px-2" data-toggle="fullscreen"
                                                  data-plugin="fullscreen"><i data-feather="maximize"></i></a></li>
        <li class="nav-item dropdown"><a class="nav-link px-2" data-toggle="dropdown"><i
                                                                                        data-feather="settings"></i> </a><!-- ############ Setting START-->
					
        </li><!-- Notification -->
        <li class="nav-item dropdown"><a class="nav-link px-2 mr-lg-2" data-toggle="dropdown"><i
                                                                                                data-feather="bell"></i> <span class="badge badge-pill badge-up bg-primary"></span>
          </a>
        </li><!-- User dropdown menu -->
        <!-- Меню пользователя -->
        <ul class="nav navbar-menu order-1 order-lg-2">
          @if (User.Identity.IsAuthenticated)
          {
            <li class="nav-item dropdown">
              <a href="#" data-toggle="dropdown" class="nav-link d-flex align-items-center px-2 text-color">
                <span class="dropdown-toggle mx-2 d-none l-h-1x d-lg-block text-right">@User.Identity.Name</span>
                @{
                  var profilePicture = User.Claims.FirstOrDefault(c => c.Type == "ProfilePictureUrl")?.Value;
                  if (!string.IsNullOrEmpty(profilePicture))
                  {
                    // Если путь начинается с "../", заменяем на "~/"
                    profilePicture = profilePicture.StartsWith("../") ? profilePicture.Replace("../", "~/") : profilePicture;
                  }
                }
                @if (!string.IsNullOrEmpty(profilePicture))
                {
                  <span class="avatar w-24" style="margin: -2px">
                    <img src="@Url.Content(profilePicture)" alt="Profile Picture">
                  </span>
                }
              </a>
              <div class="dropdown-menu dropdown-menu-right w mt-3 animate fadeIn">
                <a class="dropdown-item" asp-controller="Profile" asp-action="Index">Profile</a>
                <div class="dropdown-divider"></div>
                <form asp-controller="AuthView" asp-action="Logout" method="post">
                  <button type="submit" class="dropdown-item">Sign Out</button>
                </form>
              </div>
            </li>
          }
          else
          {
            <li class="nav-item">
              <a class="nav-link px-2" asp-controller="AuthView" asp-action="Login">Sign In</a>
            </li>
          }
        </ul>
				
				
      </ul>
    </div>
  </div><!-- ############ Header END-->
  
  
  <!-- ############ Content START-->
  <div id="content" class="flex">
    <!-- ############ Main START-->
    <div class="page-container">
      <div class="bg-light">
        <div class="page-container padding">
          <div class="d-sm-flex page-heading">
            <div class="media circle w w-auto-xs mb-4">
              <div class="media-content" style="background-image:url(@(Model.ProfilePictureUrl ?? "../assets/img/question.png"))"></div>
            </div>
            <div class="d-md-flex flex">
              <div class="mx-sm-4 flex">
                <h1 class="h4 font-weight-bold mb-0">@Model.UserName</h1>
                <div class="py-4 toolbar align-items-center">
                  <button class="btn btn-raised btn-rounded btn-primary">Listen</button> <span class="text-muted">@Model.SongsCount tracks</span>
                  <button class="btn btn-white btn-rounded" data-toggle-class><span class="d-inline">Follow</span> <span class="d-none">Following</span></button> <span class="text-muted">0</span></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="page-container padding">
        <div class="d-md-flex">
          <div class="flex">
            <div class="d-flex">
              <ul class="nav nav-sm text-sm nav-pills nav-rounded py-4">
                @if (Model.IsCurrentUser)
                {
                  <li class="nav-item"><a class="nav-link active" href="#tracks" data-toggle="tab">Tracks</a></li>
                }
                <li class="nav-item"><a class="nav-link" href="#liked" data-toggle="tab">Liked</a></li>
                <li class="nav-item"><a class="nav-link" href="#following" data-toggle="tab">Following</a></li>
              </ul>
            </div>
            <div class="tab-content">
              <div class="tab-pane fade show active" id="tracks">
                <div class="row list-row">
                    @if (!Model.IsArtist)
                    {
                        <div class="text-center mt-4 w-100">
                            <p class="text-muted">Вы не являетесь автором! У Вас нет собственных треков!</p>
                        </div>
                    }
                    else if (Model.Songs != null && Model.Songs.Any())
                    {
                        @foreach (var song in Model.Songs)
                        {
                            <div class="col-12" data-id="@song.Id" data-category="all" data-tag="all" data-source="@song.AudioUrl">
                                <div class="list-item r">
                                    <div class="media">
                                        <a href="#" class="ajax media-content" style="background-image:url(@(song.CoverUrl ?? "../assets/img/c0.jpg"))"></a>
                                        <div class="media-action media-action-overlay">
                                            <button class="btn btn-icon no-bg no-shadow hide-row" data-toggle-class>
                                                <i data-feather="heart" class="@(song.IsLiked ? "active-danger" : "")"></i>
                                            </button>
                                            <button class="btn btn-raised btn-icon btn-rounded bg--white btn-play"></button>
                                            <button class="btn btn-icon no-bg no-shadow hide-row btn-more" data-toggle="dropdown">
                                                <i data-feather="more-horizontal"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right"></div>
                                        </div>
                                    </div>
                                    <div class="list-content text-center">
                                        <div class="list-body">
                                            <a href="#" class="list-title title ajax h-1x">@song.Title</a>
                                            <a href="#" class="list-subtitle d-block text-muted subtitle ajax h-1x">@song.ArtistName</a>
                                        </div>
                                    </div>
                                    <div class="list-action show-row">
                                        <div class="d-flex align-items-center">
                                            <div class="px-3 text-sm d-none d-md-block">@(song.Duration.ToString("mm\\:ss"))</div>
                                            <button class="btn btn-icon no-bg no-shadow" data-toggle-class>
                                                <i data-feather="heart" class="@(song.IsLiked ? "active-danger" : "")"></i>
                                            </button>
                                            <button class="btn btn-icon no-bg no-shadow btn-more" data-toggle="dropdown">
                                                <i data-feather="more-horizontal"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="text-center mt-4 w-100">
                            <p class="text-muted">У вас пока нет треков</p>
                        </div>
                    }
                </div>
              </div>
              
              
              <div class="tab-pane fade" id="liked">
                <div class="row list-row">
                  @if (Model.LikedSongs != null && Model.LikedSongs.Any())
                  {
                    @foreach (var song in Model.LikedSongs)
                    {
                      <div class="col-6" data-id="@song.Id" data-category="@song.Genre" data-tag="@song.Country" data-source="@song.AudioUrl">
                        <div class="list-item r">
                          <div class="media col-4">
                            <a href="#" class="ajax media-content" style="background-image:url(@song.CoverUrl)"></a>
                            <div class="media-action media-action-overlay">
                              <button class="btn btn-icon no-bg no-shadow hide-row" onclick="toggleLike(@song.Id, this)">
                                <i data-feather="heart" class="active-danger"></i>
                              </button>
                              <button class="btn btn-raised btn-icon btn-rounded bg--white btn-play"></button>
                              <button class="btn btn-icon no-bg no-shadow hide-row btn-more" data-toggle="dropdown">
                                <i data-feather="more-horizontal"></i>
                              </button>
                              <div class="dropdown-menu dropdown-menu-right"></div>
                            </div>
                          </div>
                          <div class="list-content text-center">
                            <div class="list-body">
                              <a href="#" class="list-title title ajax h-1x">@song.Title</a>
                              <a href="#" class="list-subtitle d-block text-muted subtitle ajax h-1x">@song.Artist?.Name</a>
                            </div>
                          </div>
                        </div>
                      </div>
                    }
                  }
                  else
                  {
                    <div class="text-center mt-4 w-100">
                      <p class="text-muted">У вас пока нет лайкнутых треков</p>
                    </div>
                  }
                </div>
              </div>
              <div class="tab-pane fade" id="following">
                <div class="row list media-circle">
                  <div class="col-4 col-sm-3 col-md-2-4 col-lg-2" data-id="160157606" data-category="Pop" data-tag="United Kingdom" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/Music5/v4/e2/e2/60/e2e260ca-b3d8-f8a4-1b7c-ffd95eea52c1/mzaf_6400110211813760072.plus.aac.p.m4a">
                    <div class="list-item r">
                      <div class="media">
                        <a href="music.artist.html#160157606" class="ajax media-content" style="background-image:url(../assets/img/a12.jpg)"></a>
                        <div class="media-action"></div>
                      </div>
                      <div class="list-content text-center">
                        <div class="list-body"><a href="music.artist.html#160157606" class="list-subtitle d-block text-muted subtitle ajax h-1x">Mark Ronson Feat. Bruno Mars</a></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-4 col-sm-3 col-md-2-4 col-lg-2" data-id="90835896" data-category="Electronic" data-tag="all" data-source="">
                    <div class="list-item r">
                      <div class="media">
                        <a href="music.artist.html#90835896" class="ajax media-content" style="background-image:url(../assets/img/a0.jpg)"></a>
                        <div class="media-action"></div>
                      </div>
                      <div class="list-content text-center">
                        <div class="list-body"><a href="music.artist.html#90835896" class="list-subtitle d-block text-muted subtitle ajax h-1x">Avicii</a></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-4 col-sm-3 col-md-2-4 col-lg-2" data-id="324443962" data-category="all" data-tag="USA" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/AudioPreview62/v4/bd/6b/34/bd6b3443-d4c3-26fd-91c8-d0b31ab47ee3/mzaf_8046559398209773051.plus.aac.p.m4a">
                    <div class="list-item r">
                      <div class="media">
                        <a href="music.artist.html#324443962" class="ajax media-content" style="background-image:url(../assets/img/a5.jpg)"></a>
                        <div class="media-action"></div>
                      </div>
                      <div class="list-content text-center">
                        <div class="list-body"><a href="music.artist.html#324443962" class="list-subtitle d-block text-muted subtitle ajax h-1x">The Chainsmokers Feat. Halsey</a></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-4 col-sm-3 col-md-2-4 col-lg-2" data-id="86035248" data-category="R&amp;B" data-tag="USA" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/Music1/v4/ca/8c/3d/ca8c3dc7-51cf-78b8-4fbc-7607893c155f/mzaf_6545808409327260529.plus.aac.p.m4a">
                    <div class="list-item r">
                      <div class="media">
                        <a href="music.artist.html#86035248" class="ajax media-content" style="background-image:url(../assets/img/a7.jpg)"></a>
                        <div class="media-action"></div>
                      </div>
                      <div class="list-content text-center">
                        <div class="list-body"><a href="music.artist.html#86035248" class="list-subtitle d-block text-muted subtitle ajax h-1x">Robin Thicke Feat. T.I. &amp; Pharrell</a></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-4 col-sm-3 col-md-2-4 col-lg-2" data-id="258710574" data-category="Pop" data-tag="USA" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/Music7/v4/03/c0/60/03c060ce-1617-e556-def2-4fd34d7e1f24/mzaf_8527312642501236756.plus.aac.p.m4a">
                    <div class="list-item r">
                      <div class="media">
                        <a href="music.artist.html#258710574" class="ajax media-content" style="background-image:url(../assets/img/a3.jpg)"></a>
                        <div class="media-action"></div>
                      </div>
                      <div class="list-content text-center">
                        <div class="list-body"><a href="music.artist.html#258710574" class="list-subtitle d-block text-muted subtitle ajax h-1x">Twenty One Pilots</a></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-4 col-sm-3 col-md-2-4 col-lg-2" data-id="83147960" data-category="Rock" data-tag="USA" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/Music2/v4/31/59/ea/3159ea9f-9179-5f58-76db-78d6bd6f8e66/mzaf_8681357548341273533.plus.aac.p.m4a">
                    <div class="list-item r">
                      <div class="media">
                        <a href="music.artist.html#83147960" class="ajax media-content" style="background-image:url(../assets/img/a13.jpg)"></a>
                        <div class="media-action"></div>
                      </div>
                      <div class="list-content text-center">
                        <div class="list-body"><a href="music.artist.html#83147960" class="list-subtitle d-block text-muted subtitle ajax h-1x">OneRepublic</a></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-4 col-sm-3 col-md-2-4 col-lg-2" data-id="53754394" data-category="all" data-tag="USA" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/Music/04/e1/7b/mzi.gpwvrrex.aac.p.m4a">
                    <div class="list-item r">
                      <div class="media">
                        <a href="music.artist.html#53754394" class="ajax media-content" style="background-image:url(../assets/img/a9.jpg)"></a>
                        <div class="media-action"></div>
                      </div>
                      <div class="list-content text-center">
                        <div class="list-body"><a href="music.artist.html#53754394" class="list-subtitle d-block text-muted subtitle ajax h-1x">Macklemore &amp; Ryan Lewis Feat. Ray Dalton</a></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-4 col-sm-3 col-md-2-4 col-lg-2" data-id="119205187" data-category="all" data-tag="all" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/AudioPreview128/v4/37/14/59/37145906-fb86-aca7-9b10-7477644cb56a/mzaf_168581445824271384.plus.aac.p.m4a">
                    <div class="list-item r">
                      <div class="media">
                        <a href="music.artist.html#119205187" class="ajax media-content" style="background-image:url(../assets/img/a8.jpg)"></a>
                        <div class="media-action"></div>
                      </div>
                      <div class="list-content text-center">
                        <div class="list-body"><a href="music.artist.html#119205187" class="list-subtitle d-block text-muted subtitle ajax h-1x">Omi</a></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- ############ Main END-->
  </div>
    <!-- ############ Footer START-->
    <div id="footer" class="page-footer sticky sticky-bottom">
      <div data-plugin="plyr" class="plyrist plyrist_audio plyr-list-popup bg-white b-t" id="plyrist">
        <audio controls hidden></audio>
        <div class="plyr-list" style="display:none">
          <div class="plyr-item" data-id="90835896" data-type="audio" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/Music4/v4/ba/b2/1d/bab21d96-ffab-78d6-5e4f-dd42e32562e4/mzaf_5313062365683687423.plus.aac.p.m4a" data-poster="../assets/img/c1.jpg">
            <div class="plyr-item-poster" style="background-image:url(../assets/img/c1.jpg)"></div>
            <div class="flex">
              <div class="plyr-item-title h-1x">Wake Me Up</div>
              <div class="plyr-item-author text-sm text-fade">Avicii</div>
            </div>
            <button class="plyr-item-close close text">&times;</button>
          </div>
          <div class="plyr-item" data-id="234782921" data-type="audio" data-source="https://audio-ssl.itunes.apple.com/apple-assets-us-std-000001/Music69/v4/02/4c/98/024c9802-ce83-e0b4-3cd3-11c5c6284cdb/mzaf_9006921880389738307.plus.aac.p.m4a" data-poster="../assets/img/c2.jpg">
            <div class="plyr-item-poster" style="background-image:url(../assets/img/c2.jpg)"></div>
            <div class="flex">
              <div class="plyr-item-title h-1x">Lean On</div>
              <div class="plyr-item-author text-sm text-fade">Major Lazer Feat. MØ & DJ Snake</div>
            </div>
            <button class="plyr-item-close close text">&times;</button>
          </div>
        </div>
      </div>
    </div>
    <!-- ############ Footer END-->
  </div>
<script src="../assets/js/site.min.js"></script>
<script src="../assets/js/site.js"></script>
</body>

</html>